# 正则表达式

正则表达式(Regular Expression)是一种文本模式，包括普通字符（例如，a 到 z 之间的字母）和特殊字符（称为”元字符”）。
正则表达式使用单个字符串来描述、匹配一系列匹配某个句法规则的字符串。

练习正则表达式时候可以使用网站练习，例如https://regex101.com/
也可以使用自己熟悉的语言在ide上运行，最简单的是打开浏览器，按F12打开开发者工具，在控制台中使用js进行正则匹配练习，就像下面这样。

![img](http://vegetablebird.top:888/blog/2021/11/4.png)



以前使用正则表达式，没有完全理解表达式的含义，每次需要使用的时候都是靠搜索引擎帮助，这篇文章系统的学习一下正则表达式。以后用到的时候能够手写较简单的正则表达式。

## 语法

直接匹配：

```
/abc/.test("char abc")
true
```

直接对字符串匹配是否包含abc。

**普通字符**
普通字符包括没有显式指定为元字符的所有可打印和不可打印字符。这包括所有大写和小写字母、所有数字、所有标点符号和一些其他符号。

```
/[abc]/.test("y u")
false
/[abc]/.test("yau")
true
```

[]符号匹配当中出现的字符，字符串中包含[]中出现的字符则通过。y u不包含abc的一个，yau包含a。可以使用-作为范围表示[a-z]表示出现小写字母，[A-Z]表示是否出现大写字母，[0-9]表示出现数字。

```
/[a-z]/.test("yau666")
true
/[a-z]/.test("1 2 -")
false
/[A-Y]/.test("1 2 Z-")
false
/[0-9]/.test("str1")
true
/[0-9]/.test("str")
false
```

转义字符：

| 转义字符 | 语义                                                         |
| :------- | :----------------------------------------------------------- |
| \cx      | 匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 ‘c’ 字符。 |
| \f       | 匹配一个换页符。等价于 \x0c 和 \cL。                         |
| \n       | 匹配一个换行符。等价于 \x0a 和 \cJ。                         |
| \r       | 匹配一个回车符。等价于 \x0d 和 \cM。                         |
| \s       | 匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。注意 Unicode 正则表达式会匹配全角空格符。 |
| \S       | 匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。                  |
| \t       | 匹配一个制表符。等价于 \x09 和 \cI。                         |
| \v       | 匹配一个垂直制表符。等价于 \x0b 和 \cK。                     |

```
/\s/.test(" ")
true
/[\S]/.test("   ")
false
/[\S]/.test(" 1  ")
true
/[\n]/.test(" 1 \n ")
true
```

**特殊字符**

**^** 匹配输入字符串的开始位置，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。要匹配 ^ 字符本身，请使用 \^。

```
/^30/.test("302")
true
/^30/.test("3 02")
false
/^char/.test("cha rchar")
false
```

**$** 匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 ‘\n’ 或 ‘\r’。要匹配 $ 字符本身，请使用 \$。



```
/char$/.test("char")
true
/char$/.test("cha r")
false
/char$/.test("tail char")
true
```

**( )** 标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 ( 和 )。

```
/(c)har$/.test("char")
true
/(a)har$/.test("char")
false
/(ch)ar$/.test("char")
true
```

***** 匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 \*。

```
/(ar$)*/.test("chcharar")
true
/(ar$)*/.test("")
true
/(ar$)*/.test("acr")
true
由于是匹配0次到多次，所以这样均为true
```

**+** 匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 \+。

```
/(ar$)+/.test("ar")
true
/(ar$)+/.test("a r")
false
/(ar$)+/.test("a rar")
true
/(ar$)+/.test("ararar")
true
```

**.** 匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 \. 。

```
/^head.tail$/.test("head tail")
true
/^head.tail$/.test("head-tail")
true
/^head.tail$/.test("heasd-tail")
false
/^head.tail$/.test("head12tail")
false
/^head(.)*tail$/.test("head1234tail")
true
```

**[** 标记一个中括号表达式的开始。要匹配 [，请使用 \[。
同普通表达式，匹配是否包含出现过的值

**?** 匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 \?。

```
/ta(il)?/.test("tail")
true
/ta(il)?/.test("taililil")
true
/ta(il)?/.test("ta")
true
```

**\** 将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， ‘n’ 匹配字符 ‘n’。’\n’ 匹配换行符。序列 ‘\\’ 匹配 “\”，而 ‘\(‘ 则匹配 “(“。

```
/\(/.test("()")
true
/^\[.\]$/.test("[1]")
true
/^\[.\]$/.test("[12]")
false
```

**{** 标记限定符表达式的开始。要匹配 {，请使用 \{。

```
/se{0,}/.test("s")
true
/se{0,}/.test("se")
true
/se{0,}/.test("seeee")
true
/se{0,}/.test("aeeee")
false
```

**|** 指明两项之间的一个选择。要匹配 |，请使用 \|。

```
/spring(boot|mvc)/.test("springboot")
true
/spring(boot|mvc)/.test("springmvc")
true
/spring(boot|mvc)/.test("sprin")
false
```

**限定符**
限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 * 或 + 或 ? 或 {n} 或 {n,} 或 {n,m} 共6种。

正则表达式的限定符有：

| 字符  | 描述                                                         |
| :---- | :----------------------------------------------------------- |
| *     | 匹配前面的子表达式零次或多次。例如，zo* 能匹配 “z” 以及 “zoo”。* 等价于{0,}。 |
| +     | 匹配前面的子表达式一次或多次。例如，’zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。 |
| ?     | 匹配前面的子表达式零次或一次。例如，”do(es)?” 可以匹配 “do” 、 “does” 中的 “does” 、 “doxy” 中的 “do” 。? 等价于 {0,1}。 |
| {n}   | n 是一个非负整数。匹配确定的 n 次。例如，’o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。 |
| {n,}  | n 是一个非负整数。至少匹配n 次。例如，’o{2,}’ 不能匹配 “Bob” 中的 ‘o’，但能匹配 “foooood” 中的所有 o。’o{1,}’ 等价于 ‘o+’。’o{0,}’ 则等价于 ‘o*‘。 |
| {n,m} | m 和 n 均为非负整数，其中n <= m。最少匹配 n 次且最多匹配 m 次。例如，”o{1,3}” 将匹配 “fooooood” 中的前三个 o。’o{0,1}’ 等价于 ‘o?’。请注意在逗号和两个数之间不能有空格。 |

## 修饰符

标记也称为修饰符，正则表达式的标记用于指定额外的匹配策略。

标记不写在正则表达式里，标记位于表达式之外，在js中格式如下：

`/spring(boot|mvc)/i.test("springboot")`
写在//的后面。

| 修饰符 | 含义         | 描述                                                         |
| :----- | :----------- | :----------------------------------------------------------- |
| i      | ignore       | 不区分大小写 将匹配设置为不区分大小写，搜索时不区分大小写: A 和 a 没有区别。 |
| g      | global       | 全局匹配 查找所有的匹配项。                                  |
| m      | multi line   | 多行匹配 使边界字符 ^ 和 $ 匹配每一行的开头和结尾，记住是多行，而不是整个字符串的开头和结尾。 |
| s      | 特殊字符圆点 | 中包含换行符 \n 默认情况下的圆点 . 是 匹配除换行符 \n 之外的任何字符，加上 s 修饰符之后, . 中包含换行符 \n。 |

```
/spring(boot|mvc)/i.test("Springboot")
true
/spring(boot|mvc)/i.test("SpringMVC")
true
console.log("springboot springmvc".match(/spring(boot|mvc)/g))
['springboot', 'springmvc']
console.log("springboo springMVC".match(/spring(boot|mvc)/ig))
['springMVC']
```

## 元字符补充

**[^abc]** [abc]是匹配包含a或b或c的字符串，而[^abc]匹配除了abc外的所有字符。

```
/[^abc]/.test("qwe")
true
/[^abc]/.test("a")
false
/[^abc]/.test("abc")
false
/[^abc]/.test("ab c")
true
```

**\b** 匹配一个单词边界，也就是指单词和空格间的位置。例如， ‘er\b’ 可以匹配”never” 中的 ‘er’，但不能匹配 “verb” 中的 ‘er’。

```
/bc\b/.test("abc")
true
/bc\b/.test("abcd")
false
/bc\b/.test("abc def")
true
/bc\b/.test("abcd ef")
false
```

**\B** 匹配非单词边界。’er\B’ 能匹配 “verb” 中的 ‘er’，但不能匹配 “never” 中的 ‘er’。

```
/bc\B/.test("abc")
false
/bc\B/.test("abcdef")
true
/bc\B/.test("abcd ef")
true
```

**\d** 匹配一个数字字符。等价于 [0-9]。

```
/\d/.test("abc")
false
/\d/.test("abc1")
true
/\d/.test("==1--")
true
```

**\D** 匹配一个非数字字符。等价于 [^0-9]。

```
/\D/.test("abc")
true
/\D/.test("123")
false
```

## 正则运算顺序

正则表达式从左到右进行计算，并遵循优先级顺序，这与算术表达式非常类似。

相同优先级的从左到右进行运算，不同优先级的运算先高后低。下表从最高到最低说明了各种正则表达式运算符的优先级顺序：

| 运算符                      | 描述                                                         |
| :-------------------------- | :----------------------------------------------------------- |
| \                           | 转义符                                                       |
| (), (?:), (?=), []          | 圆括号和方括号                                               |
| *, +, ?, {n}, {n,}, {n,m}   | 限定符                                                       |
| ^, $, \任何元字符、任何字符 | 定位点和序列（即：位置和顺序）                               |
| I                           | 替换，”或”操作,字符具有高于替换运算符的优先级，使得”mIfood”匹配”m”或”food”。若要匹配”mood”或”food”，请使用括号创建子表达式，从而产生”(mIf)ood”。 |

## 常用案例

**数字类**

```
纯数字 ^[0-9]*$
n位的数字 ^\d{n}$
至少n位的数字 ^\d{n,}$
m-n位的数字 ^\d{m,n}$
零和非零开头的数字 ^(0|[1-9][0-9]*)$
正数、负数、和小数 ^(\-|\+)?\d+(\.\d+)?$
```

**字符类**

```
纯数字 ^[\u4e00-\u9fa5]{0,}$
英文和数字 ^[A-Za-z0-9]+$
大小写英文字符串：^[A-Za-z]+$
Email地址 ^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$
身份证号，最后一位可能为数字或字符X (^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)
日期格式 ^\d{4}-\d{1,2}-\d{1,2}
纯中文 ^[\u4e00-\u9fa5]+$
```